# Data602_Final_project

## Problem Statement
Understanding the vehicle crashes dataset of New York and develop a multiclass classifier to classify the contributing factor for those crashes

## About the data:
The Motor Vehicle Collisions vehicle table contains details on each vehicle involved in the crash. Each row represents a motor vehicle involved in a crash. The data in this table goes back to April 2016 when crash reporting switched to an electronic system.

The Motor Vehicle Collisions data tables contain information from all police reported motor vehicle collisions in NYC. The police report (MV104-AN) is required to be filled out for collisions where someone is injured or killed, or where there is at least $1000 worth of damage.

Column Name                   Description   
- UNIQUE_ID                    Unique record code generated by system.
- COLLISION_ID                  Crash identification code. Foreign Key, matches unique_id from the Crash table.
- CRASH_DATE                  Occurrence date of collision 
- CRASH_TIME                  Occurrence time of collision 
- VEHICLE_ID                  Vehicle identification code assigned by system 
- STATE_REGISTRATION          State where vehicle is registered. 
- VEHICLE_TYPE                  Type of vehicle based on the selected vehicle category 
- VEHICLE_MAKE                  Vehicle make 
- VEHICLE_MODEL                Vehicle model
- VEHICLE_YEAR                  Year the vehicle was manufactured
- TRAVEL_DIRECTION              Direction vehicle was traveling 
- VEHICLE_OCCUPANTS            Number of vehicle occupants 
- DRIVER_SEX                  Gender of driver 
- DRIVER_LICENSE_STATUS        License, permit, unlicensed 
- DRIVER_LICENSE_JURISDICTION   State where driver license was issued.
- PRE_CRASH Pre-crash action:   Going straight, making right turn, passing, backing, etc.
- POINT_OF_IMPACT            Location on the vehicle of the initial point of impact 
- VEHICLE_DAMAGE              Location on the vehicle where most of the damage occurred 
- VEHICLE_DAMAGE_1              Additional damage locations on the vehicle 
- VEHICLE_DAMAGE_2              Additional damage locations on the vehicle 
- VEHICLE_DAMAGE_3              Additional damage locations on the vehicle 
- PUBLIC_PROPERTY_DAMAGE      Public property damaged (Yes or No) 
- PUBLIC_PROPERTY_DAMAGE_TYPE   Type of public property damaged (ex. Sign, fence, light post, etc.) 
- CONTRIBUTING_FACTOR_1        Factors contributing to the collision for designated vehicle 
- CONTRIBUTING_FACTOR_2        Factors contributing to the collision for designated vehicle 

Dataset link: https://data.cityofnewyork.us/Public-Safety/Motor-Vehicle-Collisions-Vehicles/bm4k-52h4

## Data Cleaning and Feature enginerring
### Observations
- There are very few rows like unique_id, collision_id, date and time with no missing data.
- Columns such as VEHICLE_MODEL, VEHICLE_DAMAGE_1, VEHICLE_DAMAGE_2, VEHICLE_DAMAGE_3, PUBLIC_PROPERTY_DAMAGE_TYPE have more than 65% of missing values.
- Reduced the number of rows with values 'Unspecified' by 49.8%.
- More than 90% of the data has 'No' that means in more than 90% of crashes there was no property damage.
- Most of the damages have occured at the front end of the car compared to other parts.
- A great portion of cars that were involved in an accident were either going straight or were parked.
- About 95% of people who were involved in an accident are licensed.
- Majority of accidents were caused by Males.
- In 80% of the cases there is only one person in the vehicle which was involved in an accident.
- Droping the unnecessary columns
   - UNIQUE_ID, COLLISION_ID, and VEHICLE_ID as they are unique and don't add value for this analysis.
   - CRASH_DATE, CRASH_TIME, VEHICLE_YEAR, CONTRIBUTING_FACTOR_2, and VEHICLE_MAKE as we extracted the main information from them.
   - VEHICLE_MODEL, PUBLIC_PROPERTY_DAMAGE, PUBLIC_PROPERTY_DAMAGE_TYPE as most of the data is missing.
   - STATE_REGISTRATION, DRIVER_LICENSE_STATUS, TRAVEL_DIRECTION, and DRIVER_LICENSE_JURISDICTION as data is highly skewed
   - VEHICLE_DAMAGE_cleaned as POINT_OF_IMPACT and VEHICLE_DAMAGE_cleaned very highly correlated.

## EDA
### Observations
- I observed that during the years 2017, 2018 there was an average of 175,000 accident.
- There is a decrease in the number of accidents in 2020 and 2021 due to the pandemic.
- I observed that their was a sudden spike in the number of accidents in the months of May and June.
- Contrast to common conception most of the accidents took place in the afternoon.
- Lack of attention was the major contributor for accidents followed by following too closely, not DUI or DWI.
- For the accidents having damages on the front end the driver was going straight.
- For the accidents having damages on the back end the driver was mostly backing the car.
- When there is only one person in the vehicle lack of attention and over speeding were the causes for accidents.
- Compared to females, men cause a lot of accidents due to distraction.

## Modeling
### Observations
#### Logistic regression
- When we use a logistic regression to classify the contributing factor we get a macro average of 0.312
- When it comes to driver's inattention the model has a 60% precision.
- When it comes to failure to yield right-of-way the model has a 21% precision.
- When it comes to following too closely the model has a 42.5% precision.
- When it comes to improper lane usage the model has a 15.7% precision.
- For others the model has a 16.7% precision.
#### Decision tree
- When we use a decision tree to classify the contributing factor we get a macro average of 0.295
- When it comes to driver's inattention the model has a 56% precision.
- When it comes to failure to yield right-of-way the model has a 21% precision.
- When it comes to following too closely the model has a 42% precision.
- When it comes to improper lane usage the model has a 15% precision.
- For others the model has a 13.8% precision.
#### Random forest
- When we use a Random Forest to classify the contributing factor we get a macro average of 0.329
- When it comes to driver's inattention the model has a 54% precision.
- When it comes to failure to yield right-of-way the model has a 21% precision.
- When it comes to following too closely the model has a 42% precision.
- When it comes to improper lane usage the model has a 16.6% precision.
- For others the model has a 31% precision.
#### Gradient Boosting Classifier
- When we use a gradient boosting to classify the contributing factor we get a macro average of 0.260
- When it comes to driver's inattention the model has a 51% precision.
- When it comes to failure to yield right-of-way the model has a 0% precision.
- When it comes to following too closely the model has a 45.4% precision.
- When it comes to improper lane usage the model has a 0% precision.
- For others the model has a 33.3% precision.
#### Ada Boost Classifier
- When we use a Adaboosting classifier to classify the contributing factor we get a macro average of 0.192
- When it comes to driver's inattention the model has a 54% precision.
- When it comes to failure to yield right-of-way the model has a 0% precision.
- When it comes to following too closely the model has a 43.6% precision.
- When it comes to improper lane usage the model has a 0% precision.
- For others the model has a 0% precision.

## Summary and Future Scope
I would use random forest or logistic regression as the final model. As both of these model identify the less frequently occuring classes more accurately compared to the complex algorithms like gradient boosting algortihm or adaboosting algorithm.

For the future of the project, I would like to identify various data sources that would help us look at a bigger picture of what the major contributing factors of the accident are and merge them with the existing dataset. Also, build machine learning models that could more accurately classify the contributing factor for an accident. 
